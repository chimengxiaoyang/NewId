<script>
// 在您的GitHub Pages仓库中添加一个proxy.html文件，然后：
async function fetchData() {
    const loading = document.getElementById('loading');
    const errorMessage = document.getElementById('errorMessage');
    const refreshBtn = document.getElementById('refreshBtn');
    const infoContainer = document.getElementById('infoContainer');
    
    // 显示加载状态
    loading.style.display = 'block';
    errorMessage.style.display = 'none';
    infoContainer.innerHTML = '';
    refreshBtn.disabled = true;
    refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
    
    try {
        // 尝试多种方法获取数据
        const results = await Promise.allSettled(
            urls.map(async (url) => {
                // 方法1：直接获取
                try {
                    const response = await fetch(url, {
                        mode: 'cors',
                        credentials: 'omit'
                    });
                    if (response.ok) {
                        return await response.json();
                    }
                } catch (e) {
                    console.log(`直接获取失败: ${e.message}`);
                }
                
                // 方法2：通过代理获取
                try {
                    // 使用一个公共代理
                    const proxyResponse = await fetch(`https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`);
                    if (proxyResponse.ok) {
                        return await proxyResponse.json();
                    }
                } catch (e) {
                    console.log(`代理获取失败: ${e.message}`);
                }
                
                throw new Error('所有获取方法都失败了');
            })
        );
        
        // 处理结果
        const successfulResults = results
            .filter(result => result.status === 'fulfilled')
            .map(result => result.value);
        
        if (successfulResults.length > 0) {
            const combinedData = successfulResults.flat();
            displayData(combinedData);
        } else {
            throw new Error('无法获取数据');
        }
        
    } catch (error) {
        console.error('获取数据失败:', error);
        document.getElementById('errorText').textContent = '数据加载失败，请检查网络或稍后再试';
        errorMessage.style.display = 'block';
    } finally {
        loading.style.display = 'none';
        refreshBtn.disabled = false;
        refreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i>';
    }
}
</script>
